{% extends "base.html" %}
{% block content %}

<div class="page-header">
    <div>
        <h2 class="page-title">Daftar Dosen</h2>
        <div style="color:var(--muted); font-size:13px">Unggah dan lihat daftar dosen</div>
    </div>
    <div class="page-actions">
        <a class="btn btn-ghost" href="/koordinator">Kembali</a>
    </div>
</div>

<div class="card">
    <h3>Upload Dosen (CSV/XLSX)</h3>
    <form action="/upload_dosen" method="POST" enctype="multipart/form-data" class="form-row">
        <input type="file" name="file" required>
        <button class="btn btn-primary" type="submit">Upload</button>
    </form>

    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:18px">
        <h3 style="margin:0">Daftar Dosen</h3>
        <form action="/delete_dosen_no_selection" method="POST" onsubmit="return confirm('Hapus semua dosen tanpa pilihan mata kuliah?');">
            <button class="btn btn-danger" type="submit">Hapus Dosen Tanpa Pilihan MK ({{ zero_selection|length }})</button>
        </form>
    </div>
    <div class="table-responsive">
        <table>
            <thead>
                <tr>
                    <th>Nama</th>
                    <th>Email</th>
                    <th>MK Dipilih</th>
                    <th>Sections</th>
                    <th>Aksi</th>
                </tr>
            </thead>
            <tbody>
            {% for u in users %}
            <tr>
                <td>
                    {{ u.name }}
                    {% if u.selected_count == 0 %}<span style="color:#c00;font-size:12px">(tidak memilih)</span>{% endif %}
                </td>
                <td>{{ u.email }}</td>
                <td style="text-align:center;{% if u.selected_count == 0 %}color:#c00;font-weight:bold{% endif %}">{{ u.selected_count }}</td>
                <td style="text-align:center">{{ u.section_count }}</td>
                <td>
                    <a class="btn btn-ghost" href="{{ url_for('edit_dosen', dosen_id=u._id) }}">Edit</a>
                    <a class="btn btn-danger" href="{{ url_for('delete_dosen', dosen_id=u._id) }}">Hapus</a>
                </td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>

{% endblock %}
